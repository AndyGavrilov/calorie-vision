# Calorie Vision

Проект для обучения **мультимодальной нейросети**, предсказывающей **калорийность блюд по фотографии и текстовому описанию ингредиентов**.

## Структура проекта
```
configs/
└── config.yaml             # Конфигурационный файл с параметрами модели и обучения

data/
├── images/                 # Папки с изображениями блюд
├── dish.csv                # Таблица с описанием блюд
├── ingredients.csv         # Таблица с ингредиентами

models/
├── best_model.pth          # Лучшая сохранённая модель
└── model_epoch_N.pth       # Чекпоинты по эпохам

scripts/
├── dataset.py              # Класс CalorieDataset и функции для DataLoader
└── utils.py                # Вспомогательные функции (обучение, метрики, сохранение)

.gitignore
eda_train_eval.ipynb        # Основной ноутбук: EDA → обучение → валидация → выводы
requirements.txt            # Зависимости проекта
train.py                    # Скрипт для запуска обучения модели
```


## Установка
1. Установите зависимости:
```bash
pip install -r requirements.txt
```

2. Установите PyTorch с поддержкой CUDA:
```bash
pip install torch==2.5.1+cu124 --index-url https://download.pytorch.org/whl/cu124
```

## Использование
Запустите все ячейки в ноутбуке `eda_train_eval.ipynb`. 
Ноутбук содержит полный pipeline:
- Загрузка и предварительный анализ данных (EDA)
- Создание и обучение модели
- Валидация и тестирование (в том числе с TTA)
- Анализ ошибок и визуализация результатов

## Конфигурация

Все параметры (модели, гиперпараметры, пути и настройки аугментаций) задаются в файле: `configs/config.yaml`


## Результаты
1. Финальные метрики на тестовом наборе (с TTA):
- MAE: 33.35 ккал
- MSE: 3916.38
- RMSE: 62.58 ккал

2. Целевой порог точности (MAE < 50 ккал) достигнут.

3. Использование TTA (Test Time Augmentation) снизило MAE примерно на 3%, улучшив стабильность предсказаний.

4. Основные ошибки наблюдаются для:
- Блюд с неоднородным составом (салаты, миксы);
- Высококалорийных ингредиентов, плохо выраженных визуально (орехи, сыр, масло);
- Изображений с перекрытиями или частичными обрезами — возможный эффект агрессивных аугментаций (RandomCrop, CoarseDropout).
